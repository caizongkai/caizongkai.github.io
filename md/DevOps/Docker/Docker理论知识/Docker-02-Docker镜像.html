<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker镜像 | Java 全栈知识体系</title>
    <meta name="description" content="包含: Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, 数据库原理, MySQL, ElasticSearch, MongoDB, Docker, k8s, CI&amp;CD, Linux, DevOps, 分布式, 中间件, 开发工具, Git, IDE, 源码阅读，读书笔记, 开源项目...">
    <link rel="icon" href="/images/photo.jpg">
  <link rel="manifest" href="/images/photo.jpg">
  <link rel="apple-touch-icon" href="/images/photo.jpg">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.6aaa91c1.css" as="style"><link rel="preload" href="/assets/js/app.c0473f8a.js" as="script"><link rel="preload" href="/assets/js/15.c0ad90a0.js" as="script"><link rel="prefetch" href="/assets/js/10.18d86387.js"><link rel="prefetch" href="/assets/js/11.66cfeecb.js"><link rel="prefetch" href="/assets/js/12.cd8d3d1a.js"><link rel="prefetch" href="/assets/js/13.b7a0d653.js"><link rel="prefetch" href="/assets/js/14.1b6a79b6.js"><link rel="prefetch" href="/assets/js/16.21dd4be2.js"><link rel="prefetch" href="/assets/js/17.2f89b4b4.js"><link rel="prefetch" href="/assets/js/18.46ea7848.js"><link rel="prefetch" href="/assets/js/19.12f845cd.js"><link rel="prefetch" href="/assets/js/2.20434474.js"><link rel="prefetch" href="/assets/js/20.0b07a6df.js"><link rel="prefetch" href="/assets/js/21.10c4ca9a.js"><link rel="prefetch" href="/assets/js/22.6c080e66.js"><link rel="prefetch" href="/assets/js/23.7cf8bbaa.js"><link rel="prefetch" href="/assets/js/24.9ebb37ca.js"><link rel="prefetch" href="/assets/js/25.f68c1a55.js"><link rel="prefetch" href="/assets/js/26.b9df2f10.js"><link rel="prefetch" href="/assets/js/27.18f247d9.js"><link rel="prefetch" href="/assets/js/28.432433f3.js"><link rel="prefetch" href="/assets/js/29.1629c5f7.js"><link rel="prefetch" href="/assets/js/3.0825c95b.js"><link rel="prefetch" href="/assets/js/30.7aedcf73.js"><link rel="prefetch" href="/assets/js/31.2584afee.js"><link rel="prefetch" href="/assets/js/32.b6a772de.js"><link rel="prefetch" href="/assets/js/33.d1c11cc7.js"><link rel="prefetch" href="/assets/js/34.a9489ced.js"><link rel="prefetch" href="/assets/js/35.762fe385.js"><link rel="prefetch" href="/assets/js/36.2a12696c.js"><link rel="prefetch" href="/assets/js/37.a486ffa2.js"><link rel="prefetch" href="/assets/js/38.4a4d259e.js"><link rel="prefetch" href="/assets/js/39.725f21cc.js"><link rel="prefetch" href="/assets/js/4.07a82219.js"><link rel="prefetch" href="/assets/js/40.81274669.js"><link rel="prefetch" href="/assets/js/41.26390452.js"><link rel="prefetch" href="/assets/js/42.9315c35d.js"><link rel="prefetch" href="/assets/js/43.0af18675.js"><link rel="prefetch" href="/assets/js/44.abbecb02.js"><link rel="prefetch" href="/assets/js/45.0cce3436.js"><link rel="prefetch" href="/assets/js/5.5eab205c.js"><link rel="prefetch" href="/assets/js/6.ce6e87d0.js"><link rel="prefetch" href="/assets/js/7.d6a8f10f.js"><link rel="prefetch" href="/assets/js/8.22479811.js"><link rel="prefetch" href="/assets/js/9.b544e193.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6aaa91c1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Java 全栈知识体系</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/md/" class="nav-link router-link-active">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/JAVA/" class="nav-link">JAVA基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/计算机网络/图解网络.html" class="nav-link">图解网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/DevOps/Docker/" class="nav-link router-link-active">Docker</a></li><li class="dropdown-item"><!----> <a href="/md/DevOps/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/md/DevOps/blog/" class="nav-link">个人博客</a></li></ul></div></div> <a href="https://github.com/caizongkai/vuepressDemo" target="_blank" rel="noopener noreferrer" class="repo-link">
    修改文档
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/md/" class="nav-link router-link-active">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/JAVA/" class="nav-link">JAVA基础</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机网络</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/计算机网络/图解网络.html" class="nav-link">图解网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目部署</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/DevOps/Docker/" class="nav-link router-link-active">Docker</a></li><li class="dropdown-item"><!----> <a href="/md/DevOps/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/md/DevOps/blog/" class="nav-link">个人博客</a></li></ul></div></div> <a href="https://github.com/caizongkai/vuepressDemo" target="_blank" rel="noopener noreferrer" class="repo-link">
    修改文档
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Docker理论知识</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/md/DevOps/Docker/Docker理论知识/Docker-01-Docker概述.html" class="sidebar-link">Docker概述</a></li><li><a href="/md/DevOps/Docker/Docker理论知识/Docker-02-Docker镜像.html" class="active sidebar-link">Docker镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/DevOps/Docker/Docker理论知识/Docker-02-Docker镜像.html#docker镜像简介" class="sidebar-link">Docker镜像简介</a></li><li class="sidebar-sub-header"><a href="/md/DevOps/Docker/Docker理论知识/Docker-02-Docker镜像.html#docker镜像详解" class="sidebar-link">Docker镜像详解</a></li></ul></li><li><a href="/md/DevOps/Docker/Docker理论知识/Docker-03-Docker容器.html" class="sidebar-link">Docker容器</a></li><li><a href="/md/DevOps/Docker/Docker理论知识/Docker-04-Dockerfile详解.html" class="sidebar-link">Dockerfile详解</a></li><li><a href="/md/DevOps/Docker/Docker理论知识/Docker-05-Docker Compose详解.html" class="sidebar-link">Docker Compose详解</a></li><li><a href="/md/DevOps/Docker/Docker理论知识/Docker-06-Docker网络.html" class="sidebar-link">Docker网络</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Docker实战</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/md/DevOps/Docker/Docker实战/Docker-01-Docker安装.html" class="sidebar-link">Docker安装</a></li><li><a href="/md/DevOps/Docker/Docker实战/Docker-02-Docker部署Vue项目.html" class="sidebar-link">Docker部署Vue项目</a></li><li><a href="/md/DevOps/Docker/Docker实战/Docker-03-Linux制作SpringBoot镜像.html" class="sidebar-link">Linux制作SpringBoot镜像</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="docker镜像"><a href="#docker镜像" class="header-anchor">#</a> Docker镜像</h1> <blockquote><p>这个章节我们分为两部分去讲解</p></blockquote> <ul><li><p>Docker镜像简介</p></li> <li><p>Docker镜像详解</p></li></ul> <h2 id="docker镜像简介"><a href="#docker镜像简介" class="header-anchor">#</a> Docker镜像简介</h2> <p>你可以把Docker镜像理解为一个类（Class），镜像里面包含了一个精简的操作系统（OS），同时包含了应用运行所需要的依赖包。</p> <h2 id="docker镜像详解"><a href="#docker镜像详解" class="header-anchor">#</a> Docker镜像详解</h2> <p>首先我们来看一下镜像和容器的关系，我们可以把镜像理解为构建时的结构，把容器理解为运行时的结构。容器是镜像的运行态，一个镜像可以运行多个容器。通常镜像都比较小，容器在构建镜像的时候通常都会裁剪掉不必要的不分。</p> <p>镜像启动容器命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker container run <span class="token operator">&lt;</span>image name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>容器构建镜像命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker commit <span class="token operator">&lt;</span>container id<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>image name<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="拉取镜像"><a href="#拉取镜像" class="header-anchor">#</a> 拉取镜像</h3> <p>拉取镜像我们可以用以下命令</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker image pull <span class="token operator">&lt;</span>image name<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果版本号不写，默认拉取latest版本号的，注意：latest版本号的不一定是最新的。</p> <h3 id="为镜像打标签"><a href="#为镜像打标签" class="header-anchor">#</a> 为镜像打标签</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>docker tag <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> IMAGE<span class="token punctuation">[</span><span class="token operator">:</span>TAG<span class="token punctuation">]</span> <span class="token punctuation">[</span>REGISTRYHOST<span class="token operator">/</span><span class="token punctuation">]</span><span class="token punctuation">[</span>USERNAME<span class="token operator">/</span><span class="token punctuation">]</span>NAME<span class="token punctuation">[</span><span class="token operator">:</span>TAG<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="查看镜像列表"><a href="#查看镜像列表" class="header-anchor">#</a> 查看镜像列表</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 直接查看镜像</span>
docker image <span class="token function">ls</span> 
<span class="token comment"># 加过滤器</span>
docker image <span class="token function">ls</span> --filter <span class="token punctuation">[</span>option<span class="token punctuation">]</span>
<span class="token comment"># option可以为以下:</span>
<span class="token comment"># dangling:可以指定true或者false,仅返回悬虚镜像（true），或者非悬虚镜像</span>
<span class="token comment"># before:需要镜像名称或者ID作为参数，返回在之前被创建的全部镜像</span>
<span class="token comment"># since:和before相似，不过返回的是指定镜像之后创建的镜像</span>
<span class="token comment"># label:根据标柱的名称或者值进行过滤</span>
docker image <span class="token function">ls</span> --format <span class="token punctuation">[</span>表达式<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="移除镜像"><a href="#移除镜像" class="header-anchor">#</a> 移除镜像</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 普通移除镜像</span>
<span class="token comment"># 注意：在依赖镜像的容器停止之前，无法使用该命令移除镜像，否则会报错</span>
docker image <span class="token function">rm</span> 
 

<span class="token comment"># 移除全部镜像</span>
docker image <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker image <span class="token function">ls</span> -q<span class="token variable">)</span></span> -f
<span class="token comment"># 移除全部悬虚镜像</span>
docker image prune
<span class="token comment"># 移除没有被使用过的镜像</span>
docker image prune -a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="搜索镜像"><a href="#搜索镜像" class="header-anchor">#</a> 搜索镜像</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker search <span class="token punctuation">[</span>name<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="镜像分层"><a href="#镜像分层" class="header-anchor">#</a> 镜像分层</h3> <p>Docker镜像是由一些松耦合的只读镜像层组成，Dockerfile每一条操作指令都会构建一个镜像层，不同镜像之间可以共享镜像层，这样就可以提高性能了。</p> <p>要查看Docker的镜像层可以用</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker image inspect <span class="token punctuation">[</span>name<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="镜像摘要"><a href="#镜像摘要" class="header-anchor">#</a> 镜像摘要</h3> <p>当我们拉取了一个镜像，如果这个镜像出现了Bug，我们对这个镜像进行修复，然后把该镜像推送到远程仓库，用想通过的镜像名跟标签名，那么远程仓库的镜像会被覆盖，但是在生产环境中，我们有很多容器是依赖于这个镜像的，那么怎么区分这个镜像是新镜像还是旧镜像呢，因为他们有着相同的仓库名和标签名，这个时候镜像摘要就很关键了。</p> <p>Docker会根据镜像层的内容为每一个镜像层赋值一个分发散列值，这是一个压缩版镜像的散列值，这个散列值跟内容有关，可以校验该镜像是否被篡改过。</p> <h3 id="镜像的manifest列表"><a href="#镜像的manifest列表" class="header-anchor">#</a> 镜像的Manifest列表</h3> <p>当我们在拉取镜像的时候，有些镜像可能是Linux系统，有一些镜像是Windows的，那么怎么保证我们拉取的镜像会适配我们的系统呢？其实这部分不用我们操心，Docker本身就有一个Mainfest列表，这个Mainfest列表指向了不同的镜像层配置，当我们拉取镜像的时候，Docker会获取我们主机的CPU架构，判断我们是什么系统，然后根据这个Mainfest列表调用不同的API获取不同的镜像，这一部分对我们操作人员来说是无感的。</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/caizongkai/vuepressDemo/edit/main/docs/md/DevOps/Docker/Docker理论知识/Docker-02-Docker镜像.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.c0473f8a.js" defer></script><script src="/assets/js/15.c0ad90a0.js" defer></script>
  </body>
</html>
